#
#docker-compose.yml - build script for the mechasqueak3 irc bot
#   creates the runtime environment for the IRC bot and, by default, runs both the tests and the
#    client.
#
#    USAGE:
#       test runner:    docker-compose up tests
#       Mechasqueak:    docker-compose up mechasqueak
#       Drillsqueak:    docker-compose up drillsqueak
#       development:    docker-compose up mecha3-dev
#
#     please note that these builds require a configuration file external to git, a template
#       configuration file is provided.
#Copyright (c) 2018 The Fuel Rats Mischief,
#All rights reserved.
#
#Licensed under the BSD 3-Clause License.
#
#See LICENSE.md
#

version: '3'
services:
  tests:
    volumes:
      - ./logs :/mechasqueak/logs
      - ./config :/mechasqueak/config
    build: .
    image: mecha3
    command: "pytest"

  mecha3-dev:
    volumes:
      - ./logs :/mechasqueak/logs
      - ./config :/mechasqueak/config
    build: .
    image: mecha3
    command: ["python","main.py","./config/develop.json"]
#    expose:
#      - 6697:6697

  drillsqueak:
    volumes:
      - ./logs :/mechasqueak/logs
      - ./config :/mechasqueak/config
    build: .
    image: mecha3
    command: ["python","main.py","./config/drill.json"]

  mechasqueak:
    volumes:
      - ./logs :/mechasqueak/logs
      - ./config :/mechasqueak/config
    build: .
    image: mecha3
    command: ["python","main.py","./config/live.json"]

